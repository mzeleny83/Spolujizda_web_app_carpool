<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#667eea">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="manifest" href="/static/manifest.json">
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiByeD0iMjQiIGZpbGw9IiM2NjdlZWEiLz4KPHN2ZyB4PSI0OCIgeT0iNDgiIHdpZHRoPSI5NiIgaGVpZ2h0PSI5NiIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJ3aGl0ZSI+CjxwYXRoIGQ9Ik0xOC45MiA2LjAxQzE4LjcyIDUuNDIgMTguMTYgNSAxNy41IDVIMTVWM0gxM1Y1SDExVjNIOVY1SDYuNUM1Ljg0IDUgNS4yOCA1LjQyIDUuMDggNi4wMUwzIDEyVjIwQzMgMjAuNTUgMy40NSAyMSA0IDIxSDVDNS41NSAyMSA2IDIwLjU1IDYgMjBWMTlIMThWMjBDMTggMjAuNTUgMTguNDUgMjEgMTkgMjFIMjBDMjAuNTUgMjEgMjEgMjAuNTUgMjEgMjBWMTJMMTguOTIgNi4wMVpNNi41IDE2QzUuNjcgMTYgNSAxNS4zMyA1IDE0LjVTNS42NyAxMyA2LjUgMTMgOCAxMy42NyA4IDE0LjUgNy4zMyAxNiA2LjUgMTZaTTE3LjUgMTZDMTYuNjcgMTYgMTYgMTUuMzMgMTYgMTQuNVMxNi42NyAxMyAxNy41IDEzIDE5IDEzLjY3IDE5IDE0LjUgMTguMzMgMTYgMTcuNSAxNlpNNSAxMUwxOSAxMUwxNy4zIDdINi43TDUgMTFaIi8+Cjwvc3ZnPgo8L3N2Zz4K">
    <title>Spoluj√≠zda - Sd√≠len√≠ j√≠zd s mapou</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="/static/css/validation.css">
    <link rel="stylesheet" href="/static/css/slider.css">
    <link rel="stylesheet" href="/static/css/rides.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="/static/js/navigation.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js"></script>
    <script src="/static/js/traffic.js"></script>
    <script src="/static/js/offline.js"></script>
    <script src="/static/js/edit-ride.js"></script>
    
    <style>
        /* Mobiln√≠ opravy */
        @media (max-width: 768px) {
            body { -webkit-text-size-adjust: 100%; }
            input, textarea, select { font-size: 16px !important; }
            .main-content { flex-direction: column !important; }
            .left-column { width: 100% !important; order: 2; }
            .right-panel { width: 100% !important; height: 50vh !important; order: 1; }
            #map { height: 50vh !important; min-height: 300px !important; }
            .panel-toggle { display: none !important; }
            .modal-content { margin: 5% auto !important; width: 95% !important; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üöó Spoluj√≠zda</h1>
            <div class="user-info">
                <span id="connectionStatus" class="disconnected">Odpojeno</span>
            </div>
        </header>
        
        <div class="main-content">
            <div class="left-column">
                <button class="panel-toggle" id="panelToggle" onclick="togglePanel()" title="Skr√Ωt menu">‚óÄ</button>
                <div class="left-panel" id="leftPanel">
                <div class="buttons">
                    <div id="welcomeMessage" style="display: none; padding: 10px; background: #e8f5e8; border-radius: 8px; margin-bottom: 10px; text-align: center; font-weight: bold; color: #2d5a2d;"></div>
                    <div id="loginButtons" style="display: flex; gap: 5px;">
                        <button onclick="showQuickLogin()" title="Rychl√© p≈ôihl√°≈°en√≠ u≈æivatele" style="flex: 1;">üîë P≈ôihl√°≈°en√≠</button>
                        <button onclick="showQuickRegister()" title="Rychl√° registrace nov√©ho u≈æivatele" style="flex: 1;">üìù Registrace</button>
                    </div>
                    <button id="trackingBtn" onclick="toggleTracking()" title="Spust√≠/zastav√≠ sledov√°n√≠ va≈°√≠ GPS polohy a vycentruje mapu na va≈°i pozici">üìç Naj√≠t mƒõ a sledovat</button>
                    <hr style="margin: 15px 0; border: 1px solid #ddd;">
                    <button onclick="toggleOfferForm()" title="Vytvo≈ô√≠ novou nab√≠dku j√≠zdy s mo≈ænost√≠ pl√°nov√°n√≠ trasy, nastaven√≠ ceny a poƒçtu m√≠st">üöó Nab√≠dnout j√≠zdu</button>
                    <div id="editRideOption" style="display: none; margin-top: 5px;">
                        <button onclick="editLastRide()" style="background: #ffc107; color: #000;" title="Upravit posledn√≠ nab√≠dnutou j√≠zdu">‚úèÔ∏è Upravit posledn√≠ j√≠zdu</button>
                    </div>
                    <div id="offerForm" class="form-container" style="display: none;">
                        <h2>Nab√≠dnout j√≠zdu</h2>
                        <form id="rideOfferForm">
                            <input type="text" id="fromOffer" placeholder="Odkud *" required data-search-type="places">
                            <input type="text" id="toOffer" placeholder="Kam *" required data-search-type="places">
                            <input type="datetime-local" id="departureOffer" required title="Datum a ƒças odjezdu *">
                            <input type="number" id="seatsOffer" placeholder="Poƒçet m√≠st *" min="1" max="8" required>
                            <input type="number" id="priceOffer" placeholder="Cena za osobu (Kƒç) *" min="0" required>
                            <div style="display: flex; gap: 5px; margin: 10px 0;">
                                <button type="button" onclick="planRouteFromLocation()" style="flex: 1; font-size: 12px;" title="Zaƒçne pl√°nov√°n√≠ od va≈°√≠ aktu√°ln√≠ polohy">üìç Od m√© polohy</button>
                                <button type="button" onclick="planRouteManual()" style="flex: 1; font-size: 12px;" title="Ruƒçn√≠ pl√°nov√°n√≠ klik√°n√≠m na mapu - klikejte na mapu pro p≈ôid√°n√≠ bod≈Ø trasy">üó∫Ô∏è Ruƒçnƒõ na mapƒõ</button>
                            </div>
                            <div id="routeWaypoints"></div>
                            <button type="submit" title="Ulo≈æ√≠ va≈°i nab√≠dku j√≠zdy do datab√°ze a zobraz√≠ ji ostatn√≠m u≈æivatel≈Øm">Nab√≠dnout j√≠zdu</button>
                            <button type="button" onclick="clearRoute()" style="background: #dc3545; color: white; width: 100%; margin: 5px 0;" title="Vyma≈æe celou napl√°novanou trasu">üóëÔ∏è Vymazat trasu</button>
                        </form>
                        
                        <!-- Mo≈ænost √∫pravy posledn√≠ j√≠zdy -->
                        <div id="editRideOption" style="display: none; margin-top: 15px; padding: 10px; background: #fff3cd; border-radius: 8px; border: 1px solid #ffeaa7;">
                            <h4 style="margin: 0 0 10px 0; color: #856404;">‚úèÔ∏è Upravit posledn√≠ j√≠zdu</h4>
                            <p style="margin: 0 0 10px 0; font-size: 14px; color: #856404;">M≈Ø≈æete upravit svou posledn√≠ nab√≠dnutou j√≠zdu:</p>
                            <button onclick="loadRideForEdit()" style="background: #ffc107; color: #212529; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer;" title="Naƒçte √∫daje posledn√≠ j√≠zdy pro √∫pravu">‚úèÔ∏è Upravit j√≠zdu</button>
                            <button onclick="hideEditRideOption()" style="background: #6c757d; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin-left: 10px;" title="Skryje mo≈ænost √∫pravy j√≠zdy">Skr√Ωt</button>
                        </div>
                    </div>
                    
                    <button onclick="toggleSearchForm()" title="Vyhled√° dostupn√© j√≠zdy podle zadan√Ωch krit√©ri√≠ s mo≈ænost√≠ filtrov√°n√≠ podle ceny a hodnocen√≠">üîç Hledat j√≠zdu</button>
                    <div id="results" class="results-container"></div> <!-- Moved here -->
                    <div id="searchForm" class="form-container" style="display: none;">
                        <h2>Hledat j√≠zdu</h2>
                        
                        <!-- Rozsah hled√°n√≠ -->
                        <div style="margin-bottom: 15px; padding: 10px; background: #f0f8ff; border-radius: 8px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: bold;">üìç Rozsah hled√°n√≠: <span id="rangeValue">10</span> km</label>
                            <input type="range" id="searchRange" min="1" max="100" value="10" 
                                   style="width: 100%; margin-bottom: 5px;" 
                                   oninput="updateRangeValue(this.value)" 
                                   onchange="autoSearchAllRides()" 
                                   title="Nastav√≠ rozsah hled√°n√≠ j√≠zd kolem va≈°√≠ polohy">
                            <div style="display: flex; justify-content: space-between; font-size: 12px; color: #666;">
                                <span>1 km</span>
                                <span>50 km</span>
                                <span>100 km</span>
                            </div>
                        </div>
                        <form id="rideSearchForm">
                            <input type="text" id="fromSearch" placeholder="Odkud (voliteln√©)" title="Zadejte v√Ωchoz√≠ m√≠sto - nech√°te-li pr√°zdn√©, hled√° se kolem va≈°√≠ polohy" data-search-type="places">
                            <input type="text" id="toSearch" placeholder="Kam (voliteln√©)" title="Zadejte c√≠lov√© m√≠sto - nech√°te-li pr√°zdn√©, hled√° se kolem va≈°√≠ polohy" data-search-type="places">
                            
                            <h4>üîç Filtry</h4>
                            <input type="number" id="maxPrice" placeholder="Max. cena (Kƒç)" min="0">

                            <button type="submit" title="Vyhled√° dostupn√© j√≠zdy podle zadan√Ωch krit√©ri√≠ a zobraz√≠ je se≈ôazen√© podle vzd√°lenosti">Hledat s filtry</button>
                        </form>
                        <button onclick="showAllRides()" style="width: 100%; margin-bottom: 15px; background: #28a745; margin-top: 15px;" title="Zobraz√≠ v≈°echny dostupn√© j√≠zdy">üîç Zobrazit v≈°echny j√≠zdy</button>
                    </div>
                    
                    <button onclick="toggleUserSearch()" title="Vyhled√° u≈æivatele podle emailu nebo telefonu a zobraz√≠ ho na mapƒõ">üë§ Hledat u≈æivatele</button>
                    <div id="userSearchForm" class="form-container" style="display: none;">
                        <h2>Hledat u≈æivatele</h2>
                        <input type="text" id="userSearchInput" placeholder="Email nebo telefon" title="Zadejte email nebo telefon u≈æivatele">
                        <button onclick="searchUser()" title="Vyhled√° u≈æivatele a zobraz√≠ ho na mapƒõ">Vyhledat</button>
                        <div id="userSearchResults"></div>
                    </div>
                    
                    <button onclick="toggleRecurringForm()" title="Vytvo≈ô√≠ pravidelnou j√≠zdu pro vybran√© dny v t√Ωdnu, kter√° se automaticky opakuje">üîÅ Pravideln√© j√≠zdy</button>
                    <div id="recurringForm" class="form-container" style="display: none;">
                        <h2>üîÅ Pravideln√© j√≠zdy</h2>
                        <form id="recurringRideForm">
                            <input type="text" id="fromRecurring" placeholder="Odkud *" required data-search-type="places">
                            <input type="text" id="toRecurring" placeholder="Kam *" required data-search-type="places">
                            <input type="time" id="timeRecurring" required title="ƒåas odjezdu *">
                            
                            <h4>Dny v t√Ωdnu: *</h4>
                            <div style="display: flex; flex-wrap: wrap; gap: 10px; margin: 10px 0;">
                                <label><input type="checkbox" value="1"> Pondƒõl√≠</label>
                                <label><input type="checkbox" value="2"> √öter√Ω</label>
                                <label><input type="checkbox" value="3"> St≈ôeda</label>
                                <label><input type="checkbox" value="4"> ƒåtvrtek</label>
                                <label><input type="checkbox" value="5"> P√°tek</label>
                                <label><input type="checkbox" value="6"> Sobota</label>
                                <label><input type="checkbox" value="0"> Nedƒõle</label>
                            </div>
                            
                            <input type="number" id="seatsRecurring" placeholder="Poƒçet m√≠st *" min="1" max="8" required>
                            <input type="number" id="priceRecurring" placeholder="Cena za osobu (Kƒç) *" min="0" required>
                            <button type="submit" title="Vytvo≈ô√≠ pravidelnou j√≠zdu pro vybran√© dny v t√Ωdnu, kter√° se automaticky opakuje">Vytvo≈ôit pravidelnou j√≠zdu</button>
                        </form>
                        
                        <div id="recurringRidesList"></div>
                    </div>
                    
                    <button onclick="toggleActiveRides()" title="Zobraz√≠ seznam v≈°ech aktivn√≠ch j√≠zd na mapƒõ s mo≈ænost√≠ kontaktov√°n√≠ ≈ôidiƒç≈Ø">üìä Aktivn√≠ j√≠zdy</button>
                    <div id="activeRides" class="active-rides" style="display: none;">
                        <h3>Aktivn√≠ j√≠zdy na mapƒõ</h3>
                        <div id="ridesList"></div>
                    </div>
                    
                    <button onclick="toggleSettings()" title="Otev≈ôe nastaven√≠ aplikace, registraci, p≈ôihl√°≈°en√≠ a statistiky u≈æivatele">‚öôÔ∏è Nastaven√≠</button>
                    <div id="settingsForm" class="form-container" style="display: none;">
                        <h2>‚öôÔ∏è Nastaven√≠</h2>
                        
                        <div id="userSection">
                            <h3>üë§ U≈æivatelsk√Ω profil</h3>
                            <div id="notLoggedIn">
                                <p>Pro p≈ô√≠stup k profilu se p≈ôihlaste pomoc√≠ tlaƒç√≠tek v menu.</p>
                            </div>
                            
                            <div id="userProfile" style="display: none;">
                                <h4>üë§ V√°≈° profil</h4>
                                <p id="userNameProfile"></p>
                                <p id="userPhoneProfile"></p>
                                <p id="userRatingProfile"></p>
                                <button onclick="logoutUser()">üö™ Odhl√°sit se</button>
                            </div>
                        </div>
                        
                        <hr style="margin: 20px 0;">
                        
                        <div id="appSection">
                            <h3>üì± Mobiln√≠ aplikace</h3>
                            <p>Nainstalujte si Spoluj√≠zdu jako mobiln√≠ aplikaci pro lep≈°√≠ z√°≈æitek!</p>
                            <button id="installAppBtn" onclick="installApp()" style="display: none;" title="Nainstaluje aplikaci jako PWA (Progressive Web App) pro offline pou≈æit√≠">üì± Nainstalovat aplikaci</button>
                            <p id="installStatus">Aplikace je ji≈æ nainstalov√°na nebo nen√≠ podporov√°na</p>
                            
                            <h4>üîî Notifikace</h4>
                            <button onclick="enableNotifications()" title="Povol√≠ push notifikace pro upozornƒõn√≠ na nov√© j√≠zdy a zpr√°vy">üîî Povolit notifikace</button>
                            <p id="notificationStatus">Stav notifikac√≠: Nepovoleny</p>
                            
                            <h4>üìä Statistiky</h4>
                            <div id="userStats">
                                <p id="totalRides">Celkem j√≠zd: 0</p>
                                <p id="co2Saved">U≈°et≈ôeno CO2: 0 kg</p>
                                <p id="moneySaved">U≈°et≈ôeno penƒõz: 0 Kƒç</p>
                            </div>
                            <button onclick="loadUserStats()" title="Naƒçte aktu√°ln√≠ statistiky u≈æivatele (poƒçet j√≠zd, u≈°et≈ôen√© CO2 a pen√≠ze)">Aktualizovat statistiky</button>
                        </div>
                    </div>
                    
                    <hr style="margin: 20px 0; border: 1px solid #ddd;">
                    <h4 style="margin-bottom: 10px; color: #333;">üó∫Ô∏è Ovl√°d√°n√≠ mapy</h4>


                    <button onclick="clearRideMarkers()" style="background: #6c757d;" title="Odstran√≠ v≈°echny markery j√≠zd z mapy pro lep≈°√≠ p≈ôehlednost">üßΩ Vymazat j√≠zdy</button>
                    <button onclick="stopVoiceGuidance()" style="background: #dc3545;" title="Zastav√≠ hlasovou navigaci a v≈°echny aktivn√≠ hlasov√© pokyny">üîá Stop navigace</button>
                    
                    <div id="logoutButton" style="display: none;">
                        <hr style="margin: 15px 0; border: 1px solid #ddd;">
                        <button onclick="logoutUser()" style="background: #dc3545; color: white;" title="Odhl√°s√≠ u≈æivatele a vr√°t√≠ na p≈ôihlasovac√≠ obrazovku">üö∫ Odhl√°sit se</button>
                    </div>
                </div>

            
            <!-- Modal pro hodnocen√≠ -->
            <div id="ratingModal" class="modal" style="display: none;">
                <div class="modal-content">
                    <span class="close" onclick="closeRatingModal()">&times;</span>
                    <h3>‚≠ê Ohodnotit u≈æivatele</h3>
                    <div id="ratingForm">
                        <p id="ratingUserName"></p>
                        <div class="star-rating">
                            <span class="star" data-rating="0.5">‚≠ê</span>
                            <span class="star" data-rating="1">‚≠ê</span>
                            <span class="star" data-rating="1.5">‚≠ê</span>
                            <span class="star" data-rating="2">‚≠ê</span>
                            <span class="star" data-rating="2.5">‚≠ê</span>
                            <span class="star" data-rating="3">‚≠ê</span>
                            <span class="star" data-rating="3.5">‚≠ê</span>
                            <span class="star" data-rating="4">‚≠ê</span>
                            <span class="star" data-rating="4.5">‚≠ê</span>
                            <span class="star" data-rating="5">‚≠ê</span>
                        </div>
                        <textarea id="ratingComment" placeholder="Koment√°≈ô (voliteln√Ω)"></textarea>
                        <button onclick="submitRating()">Odeslat hodnocen√≠</button>
                    </div>
                </div>
            </div>
                </div>
            </div>
            
            <div class="right-panel">
                <div class="map-container">
                    <div id="map">
                        <button class="fullscreen-toggle" onclick="toggleFullscreen()" title="Cel√° obrazovka">‚õ∂</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Chat modal -->
        <div id="chatModal" class="modal" style="display: none;">
            <div class="modal-content" style="height: 70%; max-height: 500px;">
                <span class="close" onclick="closeChatModal()">&times;</span>
                <h3 id="chatTitle">üí¨ Chat j√≠zdy</h3>
                <div id="chatMessages" style="height: 300px; overflow-y: auto; border: 1px solid #ddd; padding: 10px; margin: 10px 0; background: #f9f9f9;"></div>
                <div style="display: flex; gap: 10px;">
                    <input type="text" id="chatInput" placeholder="Napi≈°te zpr√°vu..." style="flex: 1;" onkeypress="if(event.key==='Enter') sendChatMessage()" title="Zadejte text zpr√°vy a stisknƒõte Enter nebo kliknƒõte na Odeslat">
                    <button onclick="sendChatMessage()" title="Ode≈°le napsanou zpr√°vu do chatu v re√°ln√©m ƒçase">üì® Odeslat</button>
                    <button onclick="shareLocation()" style="background: #28a745;" title="Sd√≠l√≠ va≈°i aktu√°ln√≠ GPS polohu s ostatn√≠mi √∫ƒçastn√≠ky chatu">üìç Sd√≠let polohu</button>
                </div>
            </div>
        </div>
        
        <!-- Login modal -->
        <div id="loginModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; overflow-y: auto;" onclick="closeLoginModal()">
            <div class="modal-content" onclick="event.stopPropagation()" style="position: relative; margin: 15% auto; max-width: 400px; background: white; border-radius: 10px; padding: 20px; max-height: 80vh; overflow-y: auto;">
                <span class="close" onclick="closeLoginModal()">&times;</span>
                <h3>üîë P≈ôihl√°≈°en√≠</h3>
                <div id="loginRequiredMessage" style="display: none; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 5px; padding: 10px; margin: 10px 0; color: #856404; text-align: center;">
                    ‚ö†Ô∏è Je nejprve nutn√© se p≈ôihl√°sit pro pou≈æ√≠v√°n√≠ t√©to aplikace
                </div>
                <input type="text" id="modalLoginPhone" placeholder="Telefon (123456789) nebo email" style="width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;" onkeypress="if(event.key==='Enter') modalLoginUser()">
                <div style="position: relative; margin: 10px 0;">
                    <input type="password" id="modalLoginPassword" placeholder="Heslo" style="width: 100%; padding: 12px 45px 12px 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;" onkeypress="if(event.key==='Enter') modalLoginUser()">
                    <button type="button" onclick="togglePasswordVisibility('modalLoginPassword', this)" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; font-size: 18px;">üëÅÔ∏è</button>
                </div>
                <button onclick="modalLoginUser()" style="width: 100%; padding: 12px; margin: 10px 0; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer;">üîë P≈ôihl√°sit se</button>
                <p style="text-align: center; margin: 10px 0;">Nem√°te √∫ƒçet? <a href="#" onclick="closeLoginModal(); showQuickRegister()" style="color: #667eea;">Registrujte se</a></p>
            </div>
        </div>
        
        <!-- Register modal -->
        <div id="registerModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; overflow-y: auto;" onclick="closeRegisterModal()">
            <div class="modal-content" onclick="event.stopPropagation()" style="position: relative; margin: 5% auto; max-width: 500px; background: white; border-radius: 10px; padding: 20px; max-height: 90vh; overflow-y: auto;">
                <span class="close" onclick="closeRegisterModal()">&times;</span>
                <h3>üìù Registrace</h3>
                <input type="text" id="modalRegName" placeholder="Va≈°e jm√©no *" style="width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;">
                <input type="tel" id="modalRegPhone" placeholder="Telefonn√≠ ƒç√≠slo (9 ƒç√≠slic) *" style="width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;">
                <input type="email" id="modalRegEmail" placeholder="Email (voliteln√Ω)" style="width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;">
                <div style="position: relative; margin: 10px 0;">
                    <input type="password" id="modalRegPassword" placeholder="Heslo *" style="width: 100%; padding: 12px 45px 12px 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;">
                    <button type="button" onclick="togglePasswordVisibility('modalRegPassword', this)" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; font-size: 18px;">üëÅÔ∏è</button>
                </div>
                <div style="position: relative; margin: 10px 0;">
                    <input type="password" id="modalRegPasswordConfirm" placeholder="Potvrdit heslo *" style="width: 100%; padding: 12px 45px 12px 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;">
                    <button type="button" onclick="togglePasswordVisibility('modalRegPasswordConfirm', this)" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; font-size: 18px;">üëÅÔ∏è</button>
                </div>
                
                <!-- Podm√≠nky pou≈æ√≠v√°n√≠ -->
                <label style="display: flex; align-items: flex-start; margin: 10px 0; font-size: 13px; cursor: pointer; line-height: 1.3;">
                    <input type="checkbox" id="modalRegTerms" style="margin-right: 8px; margin-top: 2px; transform: scale(1.1);" required>
                    <span>* Souhlas√≠m s <a href="#" onclick="showTermsModal()" style="color: #007bff; text-decoration: underline;">podm√≠nkami pou≈æ√≠v√°n√≠</a></span>
                </label>
                
                <!-- Ochrana osobn√≠ch √∫daj≈Ø -->
                <label style="display: flex; align-items: flex-start; margin: 10px 0; font-size: 13px; cursor: pointer; line-height: 1.3;">
                    <input type="checkbox" id="modalRegPrivacy" style="margin-right: 8px; margin-top: 2px; transform: scale(1.1);" required>
                    <span>* Souhlas√≠m se <a href="#" onclick="showPrivacyModal()" style="color: #007bff; text-decoration: underline;">zpracov√°n√≠m osobn√≠ch √∫daj≈Ø</a></span>
                </label>
                
                <!-- Vƒõkov√© omezen√≠ -->
                <label style="display: flex; align-items: flex-start; margin: 10px 0; font-size: 13px; cursor: pointer; line-height: 1.3;">
                    <input type="checkbox" id="modalRegAge" style="margin-right: 8px; margin-top: 2px; transform: scale(1.1);" required>
                    <span>* Potvrzuji, ≈æe jsem star≈°√≠ 18 let</span>
                </label>
                
                <!-- Marketingov√© komunikace (voliteln√©) -->
                <label style="display: flex; align-items: flex-start; margin: 10px 0; font-size: 13px; cursor: pointer; line-height: 1.3;">
                    <input type="checkbox" id="modalRegMarketing" style="margin-right: 8px; margin-top: 2px; transform: scale(1.1);">
                    <span>Souhlas√≠m s pos√≠l√°n√≠m informac√≠ o nov√Ωch funkc√≠ch (voliteln√©)</span>
                </label>
                
                <button onclick="modalRegisterUser()" style="width: 100%; padding: 12px; margin: 10px 0; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer;">‚úÖ Registrovat</button>
                <p style="text-align: center; margin: 10px 0;">U≈æ m√°te √∫ƒçet? <a href="#" onclick="closeRegisterModal(); showQuickLogin()" style="color: #667eea;">P≈ôihlaste se</a></p>
            </div>
        </div>
        
        <!-- Terms modal -->
        <div id="termsModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1001; overflow-y: auto;" onclick="closeTermsModal()">
            <div class="modal-content" onclick="event.stopPropagation()" style="position: relative; margin: 5% auto; max-width: 600px; background: white; border-radius: 10px; padding: 20px; max-height: 90vh; overflow-y: auto;">
                <span class="close" onclick="closeTermsModal()" style="position: absolute; top: 15px; right: 20px; font-size: 28px; font-weight: bold; cursor: pointer;">&times;</span>
                <h3>üìã Podm√≠nky pou≈æ√≠v√°n√≠ a prohl√°≈°en√≠ o odpovƒõdnosti</h3>
                <div style="font-size: 14px; line-height: 1.5; color: #333;">
                    <p><strong>1. OMEZEN√ç ODPOVƒöDNOSTI:</strong> V√Ωvoj√°≈ôi a provozovatel√© aplikace Spoluj√≠zda nenesou ≈æ√°dnou odpovƒõdnost za ≈°kody, zranƒõn√≠, ztr√°ty nebo jin√© n√°sledky vznikl√© v souvislosti s pou≈æ√≠v√°n√≠m t√©to aplikace a slu≈æbami sd√≠len√≠ j√≠zd.</p>
                    
                    <p><strong>2. RIZIKA SPOLUJ√çZDY:</strong> U≈æivatel si je vƒõdom, ≈æe sd√≠len√≠ j√≠zd s nezn√°m√Ωmi osobami m≈Ø≈æe p≈ôedstavovat rizika vƒçetnƒõ, ale neomezenƒõ na: kr√°de≈æ, n√°sil√≠, nehody, po≈°kozen√≠ majetku, nebo jin√© trestn√© ƒçiny. Poskytovatel neovƒõ≈ôuje toto≈ænost ani spolehlivost u≈æivatel≈Ø.</p>
                    
                    <p><strong>3. VLASTN√ç ODPOVƒöDNOST:</strong> Ka≈æd√Ω u≈æivatel jedn√° na vlastn√≠ riziko a odpovƒõdnost. P≈ôed ka≈ædou j√≠zdou si ovƒõ≈ôte toto≈ænost spolucestuj√≠c√≠ch, informujte bl√≠zk√© o sv√© cestƒõ a dodr≈æujte z√°kladn√≠ bezpeƒçnostn√≠ opat≈ôen√≠.</p>
                    
                    <p><strong>4. Z√ÅVAZEK U≈ΩIVATELE:</strong> Registrac√≠ se zavazuji:<br>
                    ‚Ä¢ Chovat se slu≈°nƒõ a zodpovƒõdnƒõ<br>
                    ‚Ä¢ Nepou≈æ√≠vat aplikaci k nez√°konn√Ωm √∫ƒçel≈Øm<br>
                    ‚Ä¢ Respektovat ostatn√≠ u≈æivatele<br>
                    ‚Ä¢ Neposkytovat nepravdiv√© informace<br>
                    ‚Ä¢ Dodr≈æovat platn√© z√°kony a p≈ôedpisy</p>
                    
                    <p><strong>5. VYLOUƒåEN√ç N√ÅROK≈Æ:</strong> U≈æivatel se vzd√°v√° v≈°ech n√°rok≈Ø v≈Øƒçi Poskytovateli a souhlas√≠, ≈æe nebude Poskytovatele ≈æalovat ani jinak pr√°vnƒõ st√≠hat za jak√©koliv ≈°kody vznikl√© pou≈æ√≠v√°n√≠m aplikace.</p>
                    
                    <p><strong>6. OCHRANA OSOBN√çCH √ödAJ≈Æ:</strong> Va≈°e registraƒçn√≠ √∫daje (jm√©no, telefon, email) jsou chr√°nƒõny a nebudou sd√≠leny, prod√°v√°ny ani poskytov√°ny ≈æ√°dn√Ωm t≈ôet√≠m stran√°m. √ödaje jsou pou≈æity pouze pro fungov√°n√≠ aplikace a komunikaci mezi u≈æivateli.</p>
                    
                    <p><strong>7. PLATNOST:</strong> Tyto podm√≠nky jsou ned√≠lnou souƒç√°st√≠ smlouvy o pou≈æ√≠v√°n√≠ aplikace. Pokraƒçov√°n√≠m v registraci vyjad≈ôujete souhlas se v≈°emi uveden√Ωmi podm√≠nkami.</p>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button onclick="closeTermsModal()" style="background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer;">Rozum√≠m</button>
                </div>
            </div>
        </div>
        
        <!-- Privacy modal -->
        <div id="privacyModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1001; overflow-y: auto;" onclick="closePrivacyModal()">
            <div class="modal-content" onclick="event.stopPropagation()" style="position: relative; margin: 5% auto; max-width: 600px; background: white; border-radius: 10px; padding: 20px; max-height: 90vh; overflow-y: auto;">
                <span class="close" onclick="closePrivacyModal()" style="position: absolute; top: 15px; right: 20px; font-size: 28px; font-weight: bold; cursor: pointer;">&times;</span>
                <h3>üîí Zpracov√°n√≠ osobn√≠ch √∫daj≈Ø (GDPR)</h3>
                <div style="font-size: 14px; line-height: 1.5; color: #333;">
                    <p><strong>1. SPR√ÅVCE √ödAJ≈Æ:</strong> Spr√°vcem va≈°ich osobn√≠ch √∫daj≈Ø je provozovatel aplikace Spoluj√≠zda.</p>
                    
                    <p><strong>2. ZPRACOV√ÅVAN√â √ödAJE:</strong> Zpracov√°v√°me: jm√©no, telefonni ƒç√≠slo, email, GPS polohu (p≈ôi pou≈æ√≠v√°n√≠ aplikace).</p>
                    
                    <p><strong>3. √öƒåEL ZPRACOV√ÅN√ç:</strong> √ödaje pou≈æ√≠v√°me pro: registraci √∫ƒçtu, komunikaci mezi u≈æivateli, zobrazen√≠ jizd, bezpeƒçnost aplikace.</p>
                    
                    <p><strong>4. PR√ÅVN√ç Z√ÅKLAD:</strong> Zpracov√°n√≠ je zalo≈æeno na va≈°em souhlasu a plnƒõn√≠ smlouvy o poskytov√°n√≠ slu≈æeb.</p>
                    
                    <p><strong>5. SD√çLEN√ç √ödAJ≈Æ:</strong> Va≈°e √∫daje NESD√çL√çME s t≈ôet√≠mi stranami. Jsou pou≈æity pouze pro fungov√°n√≠ aplikace.</p>
                    
                    <p><strong>6. DOBA UCHOV√ÅN√ç:</strong> √ödaje uchov√°v√°me po dobu pou≈æ√≠v√°n√≠ aplikace + 1 rok po skonƒçen√≠.</p>
                    
                    <p><strong>7. VA≈†E PR√ÅVA:</strong> M√°te pr√°vo na p≈ô√≠stup, opravu, vymaz√°n√≠, p≈ôenositelnost √∫daj≈Ø a odvol√°n√≠ souhlasu.</p>
                    
                    <p><strong>8. KONTAKT:</strong> Pro ot√°zky ohlednƒõ GDPR n√°s kontaktujte p≈ôes aplikaci.</p>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button onclick="closePrivacyModal()" style="background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer;">Rozum√≠m</button>
                </div>
            </div>
        </div>
        

    </div>
    
    <script src="/static/js/script.js"></script>
    <script src="/static/js/notifications.js"></script>
    <script src="/static/js/user-search.js"></script>
    <script src="/static/js/advanced-search.js"></script>
    <script src="/static/js/search-integration.js"></script>
</body>
</html>